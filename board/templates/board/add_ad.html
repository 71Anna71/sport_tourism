{% extends 'board/base.html' %}
{% load static %}
{% block title %}ะะพะฑะฐะฒะธัั ะพะฑััะฒะปะตะฝะธะต{% endblock %}
{% block content %}
<div class="form-container">
  <a href="{% url 'index' %}" class="back-link">&larr; ะะฐะทะฐะด</a>
  <h1>ะะพะฑะฐะฒะธัั ะพะฑััะฒะปะตะฝะธะต</h1>
  <form method="post" enctype="multipart/form-data">
  {% csrf_token %}
	 {# โโโโโโโโโโ ะพััะฐะปัะฝัะต ะฟะพะปั ะผะพะดะตะปะธ ะะฑััะฒะปะตะฝะธะต โโโโโโโโโโ #}
    {{ form.ะทะฐะณะพะปะพะฒะพะบ.label_tag }}{{ form.ะทะฐะณะพะปะพะฒะพะบ }}
    {{ form.ะบะฐัะตะณะพัะธั.label_tag }}{{ form.ะบะฐัะตะณะพัะธั }}
    {{ form.ะบะพะฝัะฐะบัั.label_tag }}{{ form.ะบะพะฝัะฐะบัั }}
    {{ form.ัะตะณะธะพะฝ.label_tag }}{{ form.ัะตะณะธะพะฝ }}
    {{ form.ะพะฟะธัะฐะฝะธะต.label_tag }}{{ form.ะพะฟะธัะฐะฝะธะต }}

    {# โโโโโโโโโโ ะบัะฐัะธะฒัะน input ะดะปั ัะฐะนะปะฐ โโโโโโโโโโ #}
    <label for="id_ะธะทะพะฑัะฐะถะตะฝะธะต">ะะทะพะฑัะฐะถะตะฝะธะต:</label>
    <div class="file-wrapper">
      <span class="file-label">๐ผ ะะฐะณััะทะธัั ะธะทะพะฑัะฐะถะตะฝะธะต</span>
      {{ form.ะธะทะพะฑัะฐะถะตะฝะธะต }}  {# ัะฐะผ input type=file โ ัะตะฟะตัั ัะบััั ัะตัะตะท CSS #}
      <div class="file-name" id="file-name"></div>
    </div>

    {# โโโโโโโโโโ ะฑะปะพะบะธ ะดะพะฟ.ะดะตัะฐะปะตะน โโโโโโโโโโ #}
    <div id="pohod-fields" style="display:none;margin-top:24px;">
      <h3>ะะตัะฐะปะธ ะฟะพัะพะดะฐ</h3>
      {{ pohod_form.as_p }}
    </div>
    <div id="gid-fields" style="display:none;margin-top:24px;">
      <h3>ะะตัะฐะปะธ ะณะธะดะฐ</h3>
      {{ gid_form.as_p }}
    </div>
    <div id="snar-fields" style="display:none;margin-top:24px;">
      <h3>ะะตัะฐะปะธ ัะฝะฐััะถะตะฝะธั</h3>
      {{ snar_form.as_p }}
    </div>

    <button type="submit" class="btn-main" style="margin-top:20px;">ะกะพััะฐะฝะธัั</button>
  </form>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const cat = document.getElementById('id_ะบะฐัะตะณะพัะธั');
  const blocks = {
    'ะะพัะพะด': document.getElementById('pohod-fields'),
    'ะะธะด': document.getElementById('gid-fields'),
    'ะกะฝะฐััะถะตะฝะธะต': document.getElementById('snar-fields'),
	};

  function toggle() {
    const v = cat.options[cat.selectedIndex].text.trim();
    Object.entries(blocks).forEach(([key, el]) => {
      if (el) {
        if (key === v) {
          el.style.display = 'block';
          el.querySelectorAll('input,select,textarea').forEach(i => i.disabled = false);
        } else {
          el.style.display = 'none';
          el.querySelectorAll('input,select,textarea').forEach(i => i.disabled = true);
        }
      }
    });
  }
  if (cat) {
    cat.addEventListener('change', toggle);
    toggle();
  }
});
</script>
 
{% endblock %}
